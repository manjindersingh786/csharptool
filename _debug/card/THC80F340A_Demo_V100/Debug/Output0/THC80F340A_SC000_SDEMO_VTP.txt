#THC80F480A_Secure_AES-CBC in TOS state for VTP at 2018-10-16-17:51:53

#step0:复位卡片
dclose PCSC
dopen PCSC

#step*:Verify user's information
f 00200000081234567887654321
assert 9000

#step1:激活BL

#step2:验证BL是否完整

#step3:配置bank和HEA

#step4:擦FLASH（不含首页）
f 0050000000
assert 9000
f 002E0200020005
assert 9000

#step5:写FLASH（不含首页）
f 0050000000
assert 9000
f 0058020080768CD2515CCDB2E5D436C70DA03B041D8BAB34CDBC886E962263273095750C3B240A0DB6E13B87E1C7FCD49B452038A1485F19222CDD847C8EC290905DFB46348C3429AC336A5A24D3D47C58F5235A4C9CCF530B912D2ECDB55F88212980303C62CA2A67AC6BCF01F704646ED0FABB67F31B050FD0443DC1C35FA0077FCA58A8
assert 9000
f 0058028080549CCB49D63FDCA49BBD816B1D828F7B32F150DE44865F2F2D9E5A17A1878FE914DE634411D1F79D1276EE29AC73A128579AA712097A36931DC0CFA29CB3EBA88D62FC38F6568FF8B8B2B6FA774EC6147AF137A802382669FD49316636AAFC7DF98B750F6973DD57DA57436F08B65E88BBE3EB17268D3C80231D84D2BC9E2240
assert 9000
f 0058030080130ED9DBE9D2771D0B7C7F4A4F41D3F046CE7EE9592448065E0F5D832266007A8C8A112C47F13BBF4CECAB008B1FF230D7533584535490BA74B51D65A858940E0BE0CF49A7EB24CE0080890FB2C9850A8234A492705335CC0FF7BA2781DD3173B6A90D7879372434E303FD3BB25720CE2A59F7B6660994D9ED79B00EAD6C732B
assert 9000
f 00580380806337BD5123357FCAC1EAD76BF909E09B76C621CF0F09B7CFB00544542A72754724CBF7CCD0A16EF408ADCFBF5EBF3B3D7EC9BBAAB5E6E3FC0D2F8DA67FC299D339788DCAA1F1AAF32F205433651F8939A6CBB03C9C1A4701B27149598A7E39854CBB692E11A91AA028DCCC6896CE11D62556E221271A5DA91B6F9FEA5847E2B5
assert 9000
f 0058040080AC1471C4CD900C3F6687B6BC94CA8BAACD0BAE2044509C558F7B3AAEE1E3CEC1275C2751D45AD472A15ADD86BC3DC1C7119A11D8E0BCE7C24F01F93A698A7FF9363E86FD65F48584A48177115CA9B08EEC81EDA01DBCF2E696CAD0BEB87F6C333BBB2E4898464D355470EAC1AE2A576915C315FF560FEA30B7E9C9E7F31BA570
assert 9000
f 00580480803343C8FF0C8AF2CD49F5E00119A51E8258436B4E0F034B09B1507A31B5E79D7A328B171443A1C79456268A2A89CE2E6569EFAC43074A25CB255789AAC2C8EBE11FB6D232A29F5C166A91C006E031288A73C96E867CBA80499A10A6D2480F0BBC22B8E1F813CAEE5FE1A5035F38BBF0B774C2D448B3C3D80753C1788215250FA9
assert 9000
f 00580500800A5B522CFB999C429C7C15B73C04ABC8441D17BCDDA6FB56EA4A9AA65D9B14BC32DB581FC69A89D59FAE87F2B1652AC1FEF9DF4306A8BB2FCD23E327EE7876A15506E8C21223C2134439DBA1DBEDF9A9EA9AC5822701B997EB705AABBEAD1E800DF993CCBCA24E729265E379E68562799BB40853C38A2D118B3F76742C7F404D
assert 9000
f 005805808088C9D61A6942BFC45D274617994F69F3761051A35CEA5D97ED082FB2A253D75BD36E13AD681ED857EB4CF49848967EC83AC29A19C0BE42E13A7FC2EB1742994A55FB3644B79EE883664527AAB99C772EEAA7D7AD715311C1D7C63E936BF79F87526901C3D5AFD7ECCD1A007BCD416C76808130E3DE332039DC6C891BB6753A98
assert 9000
f 0058060080E148C182FD3964C12B327A91B46C850F19D2E80E6B59F87211D3C64C1B02464816415925B0A3D1D85E574899EC5FCE167C3AD7F820F081C9698F0AF63273686D90053C6CEB94A8ACAAED900124C32103DDBF2AA00AFE312B976A156B7F24FFFA59656343F09943E9FE1EF49177ED3E5193CF49A7CC917F2481839F6B77DFBA92
assert 9000
f 0058068080CF22F893B5BB82AC2339CCB9E985A4B358BF0D4600D4DA955B86257B4ECA963FEE95B368D35AA88F15ADEEF4B876183241882E93AF9F4112296787B83B6C4A214B1ADFBF1C118E3E8E7014A7D7A8C78B3CA91B770B68BA84D0E214BAEC81123BA3CBDEDCA61CF9C4E35474CF01BA6B8AF0176308F8874D4D3E49D89E8D6EAC3B
assert 9000
f 0058070080CBEEA37987B373FC13AFB0EC660D7D05684A2C5794B06A57282AA31E8E75D1091FCF301BCE6ADF317AADDAAE6743990175C3E3A4385A4444FE236A382DD7829DCB5F56532BD99B765FF870AC3B21521642CFEC6A956C231653A3B83B082F9EE41104859B6473B82E1D2384859BC2CB6E622A4270A6551EA29BBBAEE4684CD0EC
assert 9000
f 00580780802EDB410747E4B7AE88EFD7148B97FAD1C6E35B60C6D254A742588D5CFBC335B757D24FB1B6EA14BA769A9043F90B5AEDC8B5F137E44CF72A3782C71DB6ABB5925E7BD94AB6B50ADA489F7E1F7CDD93BF9DE5C4798E527DC1D03625664C652B4EAB48A18933EDD63F20390C893B8BBF65C8E99ADAC068583624CE4B68A0DD939E
assert 9000
f 005808008038B1C4AA1EB0A45E90FB5B5C42D4F52AEA07549513494152876CCAA24D0C10798567D60779253FAD288E8DAE49AD75144CA62F0769D557609B236199FC66A49FB0FC9EF760586258BCC266F8B1E3FCB1F1CC36F39D3F24F16E7F58C5DD3F252717D677162C6915B43E4F88C197E5971B84FDEC02D8087A8D511C30B06A9631EF
assert 9000
f 0058088080D93D068270A85DCED90B2370AF174C1C46EE7B727E4CA9FEEB73264C8A2CA85C9F34423AEC025B1CBD139B94E0940F2C8F31CEB3EB69861D818B58DD797B879642575E9B80E30C163F90FDE71F0E2B6CF647DA9ABFE74E7A31DD86A1360140F443835D0A9AB9E78F25A9AF3CF6398958DF1AA6D5818FB908D188668A2BFE8968
assert 9000
f 00580900801DF878BBA552CAEBE308E21917264D453D102AFBB2C48DD9E842418781D3B4431E1EF2C48B1FEA017D1A01A67D56975D1885CA05BCCD09B1A5A75862A9EE39EC6CE853706048A3FB4F19164DF1FFD563BF22672EE8394C147D2B5EDA0983837ADA5A00585B012287753519E31CBC20464410BAAF1765C104F19722E95C8D75D8
assert 9000
f 0058098080465D244EB45E9EB05D6CEAC3BB63AE71131383CD430DD4276F31BDB6FC6B5D224B77808C312726EBF2E357BD88A99A5601698A57B76BCFF0417DE4DFC5232811C82D7B1A600F12BC477CC5B9A864E45A1FB6D65FC9CE23CF13A60F5F33B8C4DAF270021913312F051A9BCF20011EA11801D8E1122FCCD915F59C5378B30F53FB
assert 9000
f 00580A00807332C3AA3FA55E719766259FA3265FCDB72DA2C4A5B85AAB15A054746B5FC873EFC94C7DE60812D237336EBFD95B39BE110E907C8608801E86F71E8BCA9A6B2FBCAB61ADD9007014841C9B90A00F6518C3698DE65007A89920631356577C45983B442F24533C7D97D00A13267C153F254B09CC116A1F3CCE6CED94F95D8354B2
assert 9000
f 00580A80806A1698EBEB6F272EBAD393612FF5EB61DB8FAFDCDECA0269E1C2C2025E3CBB7CB636262678AA50B10C9F5439365BF94A57A058470135E7C78DFAEC4673B604C58EC811470C6196CDD6191D54E6487A5A59E5D8B9BCA0C9E5AAE4A943F4FA7BE8D4AA5C5D0307049E7A22F56FF0FFB71D7124A80A2DE4D7AA18D310DCDE5A0CDA
assert 9000
f 00580B00800059E27DE859147D167067B324ECE80AEA2C37CA1A45721EDAFBFC499B28F37CBF5319B683D110936C37645963FA4EE6638D6EA5251F45FE69660937A3FCA1A0A5ABE82A5B64258D97CEBA3C82A305B4E284FD6CD920C7944AFBA837B42C2CA7086C66B97F0ED47EF3B21C6B08EC016A8F8AC0ADBD2C3DF44F144FA9B693FAC3
assert 9000
f 00580B8080E594A88D98116CC122E88D6D58F8046D1545E727CBE905F410D3F960C96ECB8D348B21D5A8746913A1932E0CA3D9697AAA82F9D0382FB291D9A9531C0448E98E5AE6F5624E797FA3B2297F6A7A47A9F81491AE1044D511AD3E8F0294109A6C8D184657515BB73444B5C51C4FAE97B9C12C16FD0B43A417AB64C16B217F73F06D
assert 9000

#step6:验证FLASH（不含首页）
f 0050000000
assert 9000
f 003002000C02004EB510C5A9962F179880
assert 9000

#step7:擦首页

#step8:写首页
f 0050000000
assert 9000
f 00580080801E732B56BB8EA81D7CD416E899FAC89E3CA4BFA5FD06EFC6A53026575B1151C7A318F560552EA7C2EA459A9C0B1A151AF14527B04DA9B54491F10E1F4A08E75F2D1985EF56A4071C1994A05A1AF84DB08A1AE389D0E95D93A1866BD4B2EB9D9A3E43BDDAC877A5C67072C6E4DD76697B6BA5C513DDE497755E40E5BADE2FD0DB
assert 9000
f 0058010080636C2DF1E8CBB3EB7D8D353E4EE3BCC58207E4BCA9BD67BCCCA62303671D68EFFA0E2C1793F07E340D0BAE745AA1E9AC416921F3DF817B8338099A652CEE1FC7C659A4713841A61869FB9CEC143BFEB95AFA883CE8AED4D18675BF07AF8DDEF05ED7DD853A67E64ACD1EC8E4558B8CE2205E7BDDC643EE93A7D6BAE151595812
assert 9000
f 005801808045CBDC4B7631FF01BAD7F541821416B87D049B92332C335B6A6D60F0B0A858BE1ED265B4CDFB0A57859C415C07D110CC7CD31B34AAE4EDB8F2D9765ED4B844FF5FE3CEB2F47999F41A2B6DBEB1501C0BD85441E3CF2A25881C06E415FE199A68180098DC1C99174AED4602D399FDEFCEE8FE4E32E0AE701ADBE29DB6DDE364C5
assert 9000
f 00580000806B931B0766C486FD5CD491142EAA540F78073882683A0B055F9637CCD99AC5415966116AF0914E9B15B0AD90D0AD98AB45C2B73822C08E6D854A4DBF02A6E53424B0B0FB5A8540C8B3001E2505A286BA586D5EB88A73071EBEC4772810ABB06AAB9E157A1F93944D265D93EEC4317450767F65EDB1AF4C8D4CDA2F379BAA4639
assert 9000

#step9:验证首页

#step10:初始化OTP

#step11:卡片下电
dclose PCSC
